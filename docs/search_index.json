[["index.html", "Factor coding, contrasts, and the emmeans package Overview 0.1 Learning goals:", " Factor coding, contrasts, and the emmeans package Wesley Brooks 2021-10-12 Overview I get a ton of questions from about factor variables in regression models. Two of the most common are: - Why is there a factor level missing from the results table for my regression model? - Why does my Stan model fail to “mix” or converge when this factor variable is included? I’m going to show you what is the deal with factor variables, in hopes that it will help you in your research, and that you can pass on the intuition when a colleague comes to you asking strange questions about factor variables. 0.1 Learning goals: Understand why factor variables get handled in a special way Learn about the contrasts that are built into R Demonstrate the basics of the emmeans package for analyzing factors in model fits "],["factor-coding.html", "1 Factor coding", " 1 Factor coding factor is R’s name for a categorical variable. Let’s see an example. The chickwts data set is built into R, and records the results of a 1948 experiment where chicks were fed on different diets, and their weights were measured in grams at six weeks of age. data( chickwts ) head( chickwts ) ## weight feed ## 1 179 horsebean ## 2 160 horsebean ## 3 136 horsebean ## 4 227 horsebean ## 5 217 horsebean ## 6 168 horsebean chickwts$feed ## [1] horsebean horsebean horsebean horsebean horsebean horsebean horsebean ## [8] horsebean horsebean horsebean linseed linseed linseed linseed ## [15] linseed linseed linseed linseed linseed linseed linseed ## [22] linseed soybean soybean soybean soybean soybean soybean ## [29] soybean soybean soybean soybean soybean soybean soybean ## [36] soybean sunflower sunflower sunflower sunflower sunflower sunflower ## [43] sunflower sunflower sunflower sunflower sunflower sunflower meatmeal ## [50] meatmeal meatmeal meatmeal meatmeal meatmeal meatmeal meatmeal ## [57] meatmeal meatmeal meatmeal casein casein casein casein ## [64] casein casein casein casein casein casein casein ## [71] casein ## Levels: casein horsebean linseed meatmeal soybean sunflower boxplot( weight ~ feed, data=chickwts ) There are six different types of feed: casein, horsebean, linseed, meatmeal, soybean, and sunflower. Now see what happens when I fit a linear model to this data: lm1 = lm( weight ~ feed, data=chickwts ) summary( lm1 ) ## ## Call: ## lm(formula = weight ~ feed, data = chickwts) ## ## Residuals: ## Min 1Q Median 3Q Max ## -123.909 -34.413 1.571 38.170 103.091 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 323.583 15.834 20.436 &lt; 2e-16 *** ## feedhorsebean -163.383 23.485 -6.957 2.07e-09 *** ## feedlinseed -104.833 22.393 -4.682 1.49e-05 *** ## feedmeatmeal -46.674 22.896 -2.039 0.045567 * ## feedsoybean -77.155 21.578 -3.576 0.000665 *** ## feedsunflower 5.333 22.393 0.238 0.812495 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 54.85 on 65 degrees of freedom ## Multiple R-squared: 0.5417, Adjusted R-squared: 0.5064 ## F-statistic: 15.36 on 5 and 65 DF, p-value: 5.936e-10 The casein feed isn’t shown in the results! And most of the feed types that are shown would give the chicks negative weights, which is clearly absurd. What gives?! "],["how-factors-are-coded-in-a-model.html", "2 How factors are coded in a model 2.1 The linear algebra explanation", " 2 How factors are coded in a model The short answer is that the intercept here is actually the average weight of chicks on the casein feed, and everything else is the difference from casein. So based on the first two lines of the result table, chicks on casein feed weigh 323 grams on average, and those on the horsebean feed weigh 163 grams less than that, or 160 grams. Those numbers shold make sense based on the boxplot. But why are the results reported in such a weird way? 2.1 The linear algebra explanation Imagine that your factor variable has three levels, and call them A, B, and C. You’re estimating how a continuous variable (like chick weight) depends on the factor level (like chick feed). You typically use an intercept to represent the overall average weight (aka the “grand mean”), so that you can then test whether any factor levels are different from average. This leads to a model where the grand mean \\(\\mu\\) and the factor levels \\(A\\), \\(B\\), and \\(C\\) represent the average weights, with some random noise added in, too. That’s written like this: "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
